%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
% SU2 configuration file                                                       %
% Case description: Turbulent multiphysics with RHT and CHT - solid            %
% Author: Ruben Sanchez                                                        %
% Institution: Chair for Scientific Computing, TU Kaiserslautern               %
% Date: 2019.10.10                                                             %
% File Version 7.0.0 "Blackbird"                                               %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%
% SOLVER TYPE
%%%%%%%%%%%%%%%%%%%%%%% 

SOLVER= HEAT_EQUATION

%%%%%%%%%%%%%%%%%%%%%%%
% SOLID PROPERTIES
%%%%%%%%%%%%%%%%%%%%%%%

FREESTREAM_TEMPERATURE= 373.0
MATERIAL_DENSITY= 7750

SPECIFIC_HEAT_CP = 500.0
THERMAL_CONDUCTIVITY_CONSTANT = 16.2

INC_NONDIM = DIMENSIONAL

%%%%%%%%%%%%%%%%%%%%%%%
% INPUT
%%%%%%%%%%%%%%%%%%%%%%%

MESH_FORMAT= SU2
MESH_FILENAME= mesh_cavity_257x257.su2
%
%%%%%%%%%%%%%%%%%%%%%%%
% BOUNDARY CONDITIONS
%%%%%%%%%%%%%%%%%%%%%%%

MARKER_ISOTHERMAL= ( upper , 473,  left, 373 , right, 373, lower,373)
MARKER_MONITORING= ( NONE )

%%%%%%%%%%%%%%%%%%%%%%%
% COUPLING CONDITIONS
%%%%%%%%%%%%%%%%%%%%%%%

% MARKER_CHT_INTERFACE= (leftSolid)

%%%%%%%%%%%%%%%%%%%%%%%
% LINEAR SOLVER
%%%%%%%%%%%%%%%%%%%%%%%

LINEAR_SOLVER= FGMRES
LINEAR_SOLVER_PREC= ILU
LINEAR_SOLVER_ERROR= 1E-18
LINEAR_SOLVER_ITER= 10



% --------------------------- CONVERGENCE PARAMETERS --------------------------%
%% Min value of the residual (log10 of the residual)

CONV_RESIDUAL_MINVAL= -12

%% Start convergence criteria at iteration number

CONV_STARTITER= 10

%% Number of elements to apply the criteria

CONV_CAUCHY_ELEMS= 100

%% Epsilon to control the series convergence

CONV_CAUCHY_EPS= 1E-6

%%%%%%%%%%%%%%%%%%%%%%%
% SOLUTION METHOD
%%%%%%%%%%%%%%%%%%%%%%%

INNER_ITER= 315650

NUM_METHOD_GRAD= GREEN_GAUSS
CFL_NUMBER= 200
%CFL_NUMBER= 1E12

% Convective numerical method for the heat equation (only SCALAR_UPWIND)
CONV_NUM_METHOD_HEAT= SCALAR_UPWIND
% CONV_NUM_METHOD_HEAT = SPACE_CENTERED
MUSCL_HEAT= YES
JST_SENSOR_COEFF = ( 0.5, 0.15 )
TIME_DISCRE_HEAT= EULER_IMPLICIT

BETA_FACTOR= 50
MAX_DELTA_TIME= 1.0

%%%%%%%%%%%%%%%%%%%%%%%
% OUTPUT
%%%%%%%%%%%%%%%%%%%%%%%

SOLUTION_FILENAME = solution_solid_cht
RESTART_FILENAME = restart_solid_cht
VOLUME_FILENAME = volume_solid_cht
CONV_FILENAME= history_solid_cht

SOLUTION_ADJ_FILENAME = solution_adj_solid_cht
RESTART_ADJ_FILENAME = restart_adj_solid_cht
VOLUME_ADJ_FILENAME = volume_adj_solid_cht